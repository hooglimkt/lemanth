jQuery(document).ready(function(c){var p="webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",f=0<c(".csstransitions").length;function e(e){this.element=e,this.timeline=this.element.find(".timeline"),this.timelineItems=this.timeline.find("li"),this.timelineItemsNumber=this.timelineItems.length,this.timelineStart=o(this.timelineItems.eq(0).text()),this.timelineUnitDuration=o(this.timelineItems.eq(1).text())-o(this.timelineItems.eq(0).text()),this.eventsWrapper=this.element.find(".events"),this.eventsGroup=this.eventsWrapper.find(".events-group"),this.singleEvents=this.eventsGroup.find(".single-event"),this.eventSlotHeight=this.eventsGroup.eq(0).children(".top-info").outerHeight(),this.modal=this.element.find(".event-modal"),this.modalHeader=this.modal.find(".header"),this.modalHeaderBg=this.modal.find(".header-bg"),this.modalBody=this.modal.find(".body"),this.modalBodyBg=this.modal.find(".body-bg"),this.modalMaxWidth=800,this.modalMaxHeight=480,this.animating=!1,this.initSchedule()}f||(p="noTransition"),e.prototype.initSchedule=function(){this.scheduleReset(),this.initEvents()},e.prototype.scheduleReset=function(){var e=this.mq();"desktop"!=e||this.element.hasClass("js-full")?"mobile"==e&&this.element.hasClass("js-full")?(this.element.removeClass("js-full loading"),this.eventsGroup.children("ul").add(this.singleEvents).removeAttr("style"),this.eventsWrapper.children(".grid-line").remove(),this.element.hasClass("modal-is-open")&&this.checkEventModal()):("desktop"==e&&this.element.hasClass("modal-is-open")&&this.checkEventModal("desktop"),this.element.removeClass("loading")):(this.eventSlotHeight=this.eventsGroup.eq(0).children(".top-info").outerHeight(),this.element.addClass("js-full"),this.placeEvents(),this.element.hasClass("modal-is-open")&&this.checkEventModal())},e.prototype.initEvents=function(){var t=this;this.singleEvents.each(function(){var e='<span class="event-date">'+c(this).data("start")+" - "+c(this).data("end")+"</span>";c(this).children("div").prepend(c(e)),c(this).on("click","a",function(e){e.preventDefault(),t.animating||t.openModal(c(this))})}),this.modal.on("click",".close",function(e){e.preventDefault(),t.animating||t.closeModal(t.eventsGroup.find(".selected-event"))}),this.element.on("click",".cover-layer",function(e){!t.animating&&t.element.hasClass("modal-is-open")&&t.closeModal(t.eventsGroup.find(".selected-event"))})},e.prototype.placeEvents=function(){var n=this;this.singleEvents.each(function(){var e=o(c(this).attr("data-start")),t=o(c(this).attr("data-end"))-e,e=n.eventSlotHeight*(e-n.timelineStart)/n.timelineUnitDuration,t=n.eventSlotHeight*t/n.timelineUnitDuration;c(this).css({top:e-1+"px",height:1+t+"px"})}),this.element.removeClass("loading")},e.prototype.openModal=function(e){var t,n,i,a,o,s,d,l,m,h=this,r=h.mq();this.animating=!0,this.modalHeader.find(".event-name").text(e.find(".event-name").text()),this.modalHeader.find(".event-date").text(e.find(".event-date").text()),this.modal.attr("data-event",e.parent().attr("data-event")),this.modalBody.find(".event-info").load(e.parent().attr("data-content")+".html .event-info > *",function(e){h.element.addClass("content-loaded")}),this.element.addClass("modal-is-open"),setTimeout(function(){e.parent("li").addClass("selected-event")},10),"mobile"==r?h.modal.one(p,function(){h.modal.off(p),h.animating=!1}):(t=e.offset().top-c(window).scrollTop(),n=e.offset().left,i=e.innerHeight(),a=e.innerWidth(),l=c(window).width(),m=c(window).height(),o=.8*l>h.modalMaxWidth?h.modalMaxWidth:.8*l,s=.8*m>h.modalMaxHeight?h.modalMaxHeight:.8*m,d=parseInt((l-o)/2-n),r=parseInt((m-s)/2-t),l=s/i,m=o-a,h.modal.css({top:t+"px",left:n+"px",height:s+"px",width:o+"px"}),g(h.modal,"translateY("+r+"px) translateX("+d+"px)"),h.modalHeader.css({width:a+"px"}),h.modalBody.css({marginLeft:a+"px"}),h.modalBodyBg.css({height:i+"px",width:"1px"}),g(h.modalBodyBg,"scaleY("+l+") scaleX("+m+")"),h.modalHeaderBg.css({height:i+"px",width:a+"px"}),g(h.modalHeaderBg,"scaleY("+l+")"),h.modalHeaderBg.one(p,function(){h.modalHeaderBg.off(p),h.animating=!1,h.element.addClass("animation-completed")})),f||h.modal.add(h.modalHeaderBg).trigger(p)},e.prototype.closeModal=function(e){var t,n,i,a,o=this,s=o.mq();this.animating=!0,"mobile"==s?(this.element.removeClass("modal-is-open"),this.modal.one(p,function(){o.modal.off(p),o.animating=!1,o.element.removeClass("content-loaded"),e.removeClass("selected-event")})):(t=e.offset().top-c(window).scrollTop(),a=e.offset().left,n=e.innerHeight(),i=e.innerWidth(),s=Number(o.modal.css("top").replace("px","")),a=a-Number(o.modal.css("left").replace("px","")),s=t-s,o.element.removeClass("animation-completed modal-is-open"),this.modal.css({width:i+"px",height:n+"px"}),g(o.modal,"translateX("+a+"px) translateY("+s+"px)"),g(o.modalBodyBg,"scaleX(0) scaleY(1)"),g(o.modalHeaderBg,"scaleY(1)"),this.modalHeaderBg.one(p,function(){o.modalHeaderBg.off(p),o.modal.addClass("no-transition"),setTimeout(function(){o.modal.add(o.modalHeader).add(o.modalBody).add(o.modalHeaderBg).add(o.modalBodyBg).attr("style","")},10),setTimeout(function(){o.modal.removeClass("no-transition")},20),o.animating=!1,o.element.removeClass("content-loaded"),e.removeClass("selected-event")})),f||o.modal.add(o.modalHeaderBg).trigger(p)},e.prototype.mq=function(){return window.getComputedStyle(this.element.get(0),"::before").getPropertyValue("content").replace(/["']/g,"")},e.prototype.checkEventModal=function(e){this.animating=!0;var t,n,i,a,o,s,d,l,m=this,h=this.mq();"mobile"==h?(m.modal.add(m.modalHeader).add(m.modalHeaderBg).add(m.modalBody).add(m.modalBodyBg).attr("style",""),m.modal.removeClass("no-transition"),m.animating=!1):"desktop"==h&&m.element.hasClass("modal-is-open")&&(m.modal.addClass("no-transition"),m.element.addClass("animation-completed"),(h=m.eventsGroup.find(".selected-event")).offset().top,c(window).scrollTop(),h.offset().left,t=h.innerHeight(),n=h.innerWidth(),i=c(window).width(),a=c(window).height(),o=.8*i>m.modalMaxWidth?m.modalMaxWidth:.8*i,s=.8*a>m.modalMaxHeight?m.modalMaxHeight:.8*a,d=s/t,l=o-n,setTimeout(function(){m.modal.css({width:o+"px",height:s+"px",top:a/2-s/2+"px",left:i/2-o/2+"px"}),g(m.modal,"translateY(0) translateX(0)"),m.modalBodyBg.css({height:s+"px",width:"1px"}),g(m.modalBodyBg,"scaleX("+l+")"),m.modalHeader.css({width:n+"px"}),m.modalBody.css({marginLeft:n+"px"}),m.modalHeaderBg.css({height:t+"px",width:n+"px"}),g(m.modalHeaderBg,"scaleY("+d+")")},10),setTimeout(function(){m.modal.removeClass("no-transition"),m.animating=!1},20))};var t=c(".cd-schedule"),n=[],i=!1;function a(){n.forEach(function(e){e.scheduleReset()}),i=!1}function o(e){e=(e=e.replace(/ /g,"")).split(":");return 60*parseInt(e[0])+parseInt(e[1])}function g(e,t){e.css({"-moz-transform":t,"-webkit-transform":t,"-ms-transform":t,"-o-transform":t,transform:t})}0<t.length&&t.each(function(){n.push(new e(c(this)))}),c(window).on("resize",function(){i||(i=!0,window.requestAnimationFrame?window.requestAnimationFrame(a):setTimeout(a))}),c(window).keyup(function(e){27==e.keyCode&&n.forEach(function(e){e.closeModal(e.eventsGroup.find(".selected-event"))})})});